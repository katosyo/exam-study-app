# 製品版開発ルール（Production Release Rules）

## 目的

本ディレクトリは、**第三者利用を想定した製品版リリース**のための開発ルールを定義します。

MVP/PoC で得られた知見を活かしつつ、以下を前提とした設計・実装を行います：

- ✅ 第三者（不特定多数）による利用
- ✅ データの永続性・保護
- ✅ 可用性・信頼性の確保
- ✅ セキュリティの強化
- ✅ 保守性・拡張性の担保

---

## MVP から製品版への移行方針

### 基本スタンス

**現在の MVP コードベースを段階的に改修する方式を採用**

- ❌ ゼロから作り直すことは禁止
- ✅ 既存の設計・アーキテクチャを活かす
- ✅ 機能を段階的に追加・強化する
- ✅ テスト・監視を段階的に導入する

### MVP で維持する部分

以下は MVP で構築したものをそのまま使用：

- アーキテクチャ（Next.js + Lambda + DynamoDB）
- インフラ構成（Amplify Hosting + SAM）
- CI/CD パイプライン（GitHub Actions）
- 型システム・Result 型パターン
- レイヤ構造（handler / service / repository）

### 製品版で強化する部分

以下を段階的に追加・強化：

1. **認証・ユーザー管理**（Amazon Cognito）
2. **回答履歴・学習ログの永続化**
3. **苦手分野分析・学習支援機能**
4. **エラーハンドリング・ログの強化**
5. **テストの追加**（重要なロジックから）
6. **監視・アラートの設定**

---

## ルールファイル構成

| ファイル名 | 内容 |
|----------|------|
| `00_core.md` | 開発の基本方針・セッション運用 |
| `frontend.md` | フロントエンド開発ルール |
| `backend.md` | バックエンド開発ルール |
| `api_design.md` | API 設計ルール |
| `typescript.md` | TypeScript 実装ルール |
| `security.md` | セキュリティ要件 |
| `testing.md` | テスト戦略 |
| `monitoring.md` | 監視・運用ルール |
| `database.md` | データベース設計ルール |
| `auth.md` | 認証・認可ルール |

---

## 段階的な移行計画

### Phase 1: 認証基盤の構築

- [ ] Amazon Cognito のセットアップ
- [ ] ユーザー登録・ログイン画面
- [ ] JWT トークンの管理
- [ ] Lambda オーソライザーの実装

### Phase 2: 学習履歴の永続化

- [ ] 回答履歴テーブルの作成
- [ ] 回答結果の保存 API
- [ ] 学習履歴表示機能

### Phase 3: 苦手分野分析

- [ ] 問題メタデータの拡充
- [ ] 正答率の計算ロジック
- [ ] 苦手分野抽出機能

### Phase 4: 品質・運用の強化

- [ ] テストの追加
- [ ] エラーハンドリングの強化
- [ ] ログの構造化
- [ ] CloudWatch アラートの設定

---

## 逸脱禁止

本ルールセットは製品版リリースの品質を保証するためのものです。

- ルールに反する実装を行ってはならない
- 例外が必要な場合は、理由・影響・代替案を明示すること
- MVP 時代の「速度優先」の判断は許可されない
