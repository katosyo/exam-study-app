# Release Scope Rules（正式リリース向け）

## 目的

本ドキュメントは、MVP / PoC フェーズを抜けて
**正式リリース（一般利用を想定）** する際に
"必ず実装されているべき機能・非機能要件" を事前に定義するための Rules である。

* 現時点では **実装しない**
* ただし設計・命名・構造は将来追加を阻害しないこと
* 「後で考える」を防ぐための **設計上の地雷除去** が目的

---

## フェーズ定義

* PoC / MVP：

  * 個人利用
  * データ破棄前提
  * 障害・不整合は許容

* 正式リリース：

  * 第三者利用を想定
  * データ永続・保護が前提
  * 仕様の安定性を要求

---

## 正式リリース時に必須となる機能（機能要件）

### 認証・ユーザー管理

* ユーザー認証機能

  * メール + パスワード
  * または外部 IdP（例：Google）
* ユーザー識別子（userId）の全データへの付与
* 未認証ユーザーのアクセス制御

※ MVP では Cognito 等は使用しないが、
**userId を前提とした設計は禁止しない**

---

### 学習履歴・回答履歴

* 回答結果の永続化
* 正誤・日時・問題IDの保存
* ユーザー単位での履歴取得

※ MVP では保存しないが、
問題ID・構造は履歴保存を前提とする

---

### 出題制御・学習支援

* 出題条件の拡張

  * 未回答のみ
  * 間違えた問題のみ
  * ランダム / 年度別

* 問題重複の制御

---

### 管理・運用機能

* 問題データの追加・修正
* 不正データの修正手段
* 最低限の管理者操作

※ 管理画面である必要はない（スクリプト可）

---

## 正式リリース時に必須となる非機能要件

### セキュリティ

* 認証必須 API と公開 API の分離
* 入力値検証の強化
* 想定外入力に対する安全な失敗

---

### 可用性・信頼性（最低限）

* Lambda / DynamoDB のエラーをユーザーにそのまま返さない
* 一時的な失敗時の再試行余地
* 重大障害時にデータが壊れないこと

---

### データ設計

* DynamoDB テーブル設計が

  * userId 追加に耐えられること
  * GSI 追加が可能であること

* 問題データは不変（immutable）として扱う

---

### ログ・監視

* 重要エラーは CloudWatch で追跡可能
* ユーザー操作とシステムエラーを区別したログ

---

## 設計上の制約（今すぐ守るべきこと）

* 問題IDは **将来変更不可** として設計する
* API レスポンスは将来の項目追加を妨げない構造にする
* データ削除を前提とした安易な設計をしない

---

## 禁止事項

* 「正式リリース時に全部作り直す前提」の実装
* MVP 専用と分かる命名（temp / test / sample 等）
* データ構造の破壊的変更を前提とした設計

---

## 逸脱禁止

本 Rules に反する設計・実装・命名を行ってはならない。
将来スコープ外の機能を **今すぐ実装することは禁止** するが、
**将来実装不能にする設計も同様に禁止** とする。


# Release Scope Rules（正式リリース向け）

## 基本方針

- MVPで得た学習ログを活用し、学習体験の質を向上させる
- AIは判断主体ではなく、分析結果の解釈・再構成を担う補助役とする
- 学習効果・説明可能性・試験適合性を最優先する

---

## 学習ログ・弱点分析機能

### 回答履歴の永続化

- ユーザーの回答結果（正誤）をすべて保存する
- 正誤判定はシステム側で行い、AIには委ねない
- 回答履歴は時系列で保持し、後続分析に利用可能とする

### 問題メタデータの保持

- すべての問題は以下の分類情報を持つこと
  - category（大分類）
  - subCategory（小分類）
  - difficulty（任意）
- 問題文そのものではなく、メタデータを分析の主軸とする

---

## 苦手分野の抽出ルール

- 苦手分野の判定は統計ベースで行う
  - category / subCategory 単位で正答率を算出
  - 一定基準以下のものを「苦手分野」と定義
- 苦手判定ロジックは明示的かつ再現可能であること
- AIに苦手分野の判定をさせてはならない

---

## AIエージェントの役割

### 許可される役割

- 抽出済みの苦手分野情報をもとに、以下を行う
  - 学習者向けの言語化・要約
  - 再学習ポイントの整理
  - 学習順序や重点の提案
- 分析結果の「編集者・解説者」として振る舞う

### 禁止事項

- AIが苦手分野を直接判定すること
- AIが正誤履歴を解釈して独自に評価を下すこと
- AIが試験問題を自動生成すること

---

## 苦手特化問題集機能

- 抽出された苦手分野に該当する既存問題を集約する
- 出題は以下を原則とする
  - 簡単 → 難しい順
  - 同一 subCategory 内で完結
- 問題の新規生成は行わず、品質が担保された問題のみを使用する

---

## 将来拡張に関する指針

- AIモデルの変更があっても学習ロジックに影響を与えない設計とする
- 学習ログ・判定ロジック・AI解釈層は明確に分離する
